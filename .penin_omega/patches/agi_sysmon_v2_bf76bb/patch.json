{
  "file": "/root/agents/system_monitor.py",
  "new_content": "#!/usr/bin/env python3\n\"\"\"\nAGENTE MONITOR DE SISTEMA\nCriado pelo Motor de Evolu√ß√£o AGI\n\"\"\"\n\nimport os\nimport time\nimport psutil\nimport logging\nfrom datetime import datetime\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nclass SystemMonitorAgent:\n    def __init__(self):\n        self.agent_id = \"system_monitor\"\n        self.running = True\n        self.monitor_interval = 30\n        \n    def start(self):\n        logger.info(\"üñ•Ô∏è Agente Monitor de Sistema iniciado\")\n        one_shot = os.getenv(\"ONE_SHOT\", \"0\") in (\"1\", \"true\", \"True\")\n        while self.running:\n            try:\n                self.monitor_system()\n                if one_shot:\n                    break\n                time.sleep(self.monitor_interval)\n            except Exception as e:\n                logger.error(f\"Erro no monitor: {e}\")\n                time.sleep(5)\n    \n    def monitor_system(self):\n        # Janela curta para leitura est√°vel\n        cpu_percent = psutil.cpu_percent(interval=0.2)\n        memory = psutil.virtual_memory()\n        disk = psutil.disk_usage('/')\n        load1, load5, load15 = (0.0, 0.0, 0.0)\n        try:\n            load1, load5, load15 = os.getloadavg()\n        except Exception:\n            pass\n        iowait = 0.0\n        try:\n            ct = psutil.cpu_times_percent(interval=0.1)\n            iowait = getattr(ct, 'iowait', 0.0) or 0.0\n        except Exception:\n            pass\n        \n        logger.info(f\"üìä CPU: {cpu_percent:.1f}% | RAM: {memory.percent:.1f}% | Disk: {disk.percent:.1f}% | Load1: {load1:.2f} | IOwait: {iowait:.1f}%\")\n        \n        # Detectar problemas\n        if cpu_percent > 80:\n            logger.warning(\"‚ö†Ô∏è CPU alta detectada\")\n            logger.info(\"problema detectado: CPU alta\")\n        if load1 > 50:\n            logger.warning(\"‚ö†Ô∏è Load average alto detectado\")\n            logger.info(\"problema detectado: Load average alto\")\n        if iowait > 10:\n            logger.warning(\"‚ö†Ô∏è IOwait elevado detectado\")\n            logger.info(\"problema detectado: IOwait elevado\")\n        if memory.percent > 90:\n            logger.warning(\"‚ö†Ô∏è Mem√≥ria alta detectada\")\n            logger.info(\"problema detectado: Mem√≥ria alta\")\n\nif __name__ == \"__main__\":\n    agent = SystemMonitorAgent()\n    agent.start()\n"
}